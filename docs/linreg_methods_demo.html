<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Peter Carbonetto" />


<title>Exploring methods for large-scale multiple linear regression</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">pcarbo</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Overview</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/pcarbo/pcarbo">source</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>


<div id="header">



<h1 class="title toc-ignore">Exploring methods for large-scale multiple
linear regression</h1>
<h4 class="author">Peter Carbonetto</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2023-06-02
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 6
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 1
</p>
<p>
<strong>Knit directory:</strong> <code>pcarbo/analysis/</code> <span
class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.0.5). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date
</a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git
repository, you know the exact version of the code that produced these
results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed1code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(1)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed1code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(1)</code> was run prior to running the
code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongdetected">
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> <strong>Cache:</strong> detected </a>
</p>
</div>
<div id="strongCachestrongdetected" class="panel-collapse collapse">
<div class="panel-body">
The following chunks had caches available:
<ul>
<li>
dirichlet-laplace
</li>
<li>
dirichlet-laplace-1
</li>
<li>
horseshoe
</li>
<li>
horseshoe-1
</li>
<li>
horseshoe-3
</li>
</ul>
<p>To ensure reproducibility of the results, delete the cache directory
<code>linreg_methods_demo_cache</code> and re-run the analysis. To have
workflowr automatically delete the cache directory prior to building the
file, set <code>delete_cache = TRUE</code> when running
<code>wflow_build()</code> or <code>wflow_publish()</code>.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcompcarbopcarbotreef9c677ac80711d9ca0b882f42c4847bbd6c44359targetblankf9c677aa">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://github.com/pcarbo/pcarbo/tree/f9c677ac80711d9ca0b882f42c4847bbd6c44359" target="_blank">f9c677a</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsgithubcompcarbopcarbotreef9c677ac80711d9ca0b882f42c4847bbd6c44359targetblankf9c677aa"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://github.com/pcarbo/pcarbo/tree/f9c677ac80711d9ca0b882f42c4847bbd6c44359" target="_blank">f9c677a</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    analysis/fit-scd-ex-k=10.rds
    Ignored:    analysis/train.mat
    Ignored:    sbatch/makefile_demo/sims/sim0001.csv
    Ignored:    sbatch/makefile_demo/sims/sim0002.csv
    Ignored:    sbatch/makefile_demo/sims/sim0003.csv
    Ignored:    sbatch/makefile_demo/sims/sim0004.csv
    Ignored:    sbatch/makefile_demo/sims/sim0005.csv
    Ignored:    sbatch/makefile_demo/sims/sim0006.csv
    Ignored:    sbatch/makefile_demo/sims/sim0007.csv
    Ignored:    sbatch/makefile_demo/sims/sim0008.csv
    Ignored:    sbatch/makefile_demo/sims/sim0009.csv
    Ignored:    sbatch/makefile_demo/sims/sim0010.csv
    Ignored:    sbatch/makefile_demo/sims/sim0011.csv
    Ignored:    sbatch/makefile_demo/sims/sim0012.csv
    Ignored:    sbatch/makefile_demo/sims/sim0013.csv
    Ignored:    sbatch/makefile_demo/sims/sim0014.csv
    Ignored:    sbatch/makefile_demo/sims/sim0015.csv
    Ignored:    sbatch/makefile_demo/sims/sim0016.csv
    Ignored:    sbatch/makefile_demo/sims/sim0017.csv
    Ignored:    sbatch/makefile_demo/sims/sim0018.csv
    Ignored:    sbatch/makefile_demo/sims/sim0019.csv
    Ignored:    sbatch/makefile_demo/sims/sim0020.csv
    Ignored:    sbatch/makefile_demo/sims/sim0021.csv
    Ignored:    sbatch/makefile_demo/sims/sim0022.csv
    Ignored:    sbatch/makefile_demo/sims/sim0023.csv
    Ignored:    sbatch/makefile_demo/sims/sim0024.csv
    Ignored:    sbatch/makefile_demo/sims/sim0025.csv
    Ignored:    sbatch/makefile_demo/sims/sim0026.csv
    Ignored:    sbatch/makefile_demo/sims/sim0027.csv
    Ignored:    sbatch/makefile_demo/sims/sim0028.csv
    Ignored:    sbatch/makefile_demo/sims/sim0029.csv
    Ignored:    sbatch/makefile_demo/sims/sim0030.csv
    Ignored:    sbatch/makefile_demo/sims/sim0031.csv
    Ignored:    sbatch/makefile_demo/sims/sim0032.csv
    Ignored:    sbatch/makefile_demo/sims/sim0033.csv
    Ignored:    sbatch/makefile_demo/sims/sim0034.csv
    Ignored:    sbatch/makefile_demo/sims/sim0035.csv
    Ignored:    sbatch/makefile_demo/sims/sim0036.csv
    Ignored:    sbatch/makefile_demo/sims/sim0037.csv
    Ignored:    sbatch/makefile_demo/sims/sim0038.csv
    Ignored:    sbatch/makefile_demo/sims/sim0039.csv
    Ignored:    sbatch/makefile_demo/sims/sim0040.csv
    Ignored:    sbatch/makefile_demo/sims/sim0041.csv
    Ignored:    sbatch/makefile_demo/sims/sim0042.csv
    Ignored:    sbatch/makefile_demo/sims/sim0043.csv
    Ignored:    sbatch/makefile_demo/sims/sim0044.csv
    Ignored:    sbatch/makefile_demo/sims/sim0045.csv
    Ignored:    sbatch/makefile_demo/sims/sim0046.csv
    Ignored:    sbatch/makefile_demo/sims/sim0047.csv
    Ignored:    sbatch/makefile_demo/sims/sim0048.csv
    Ignored:    sbatch/makefile_demo/sims/sim0049.csv
    Ignored:    sbatch/makefile_demo/sims/sim0050.csv
    Ignored:    sbatch/makefile_demo/sims/sim0051.csv
    Ignored:    sbatch/makefile_demo/sims/sim0052.csv
    Ignored:    sbatch/makefile_demo/sims/sim0053.csv
    Ignored:    sbatch/makefile_demo/sims/sim0054.csv
    Ignored:    sbatch/makefile_demo/sims/sim0055.csv
    Ignored:    sbatch/makefile_demo/sims/sim0056.csv
    Ignored:    sbatch/makefile_demo/sims/sim0057.csv
    Ignored:    sbatch/makefile_demo/sims/sim0058.csv
    Ignored:    sbatch/makefile_demo/sims/sim0059.csv
    Ignored:    sbatch/makefile_demo/sims/sim0060.csv
    Ignored:    sbatch/makefile_demo/sims/sim0061.csv
    Ignored:    sbatch/makefile_demo/sims/sim0062.csv
    Ignored:    sbatch/makefile_demo/sims/sim0063.csv
    Ignored:    sbatch/makefile_demo/sims/sim0064.csv
    Ignored:    sbatch/makefile_demo/sims/sim0065.csv
    Ignored:    sbatch/makefile_demo/sims/sim0066.csv
    Ignored:    sbatch/makefile_demo/sims/sim0067.csv
    Ignored:    sbatch/makefile_demo/sims/sim0068.csv
    Ignored:    sbatch/makefile_demo/sims/sim0069.csv
    Ignored:    sbatch/makefile_demo/sims/sim0070.csv
    Ignored:    sbatch/makefile_demo/sims/sim0071.csv
    Ignored:    sbatch/makefile_demo/sims/sim0072.csv
    Ignored:    sbatch/makefile_demo/sims/sim0073.csv
    Ignored:    sbatch/makefile_demo/sims/sim0074.csv
    Ignored:    sbatch/makefile_demo/sims/sim0075.csv
    Ignored:    sbatch/makefile_demo/sims/sim0076.csv
    Ignored:    sbatch/makefile_demo/sims/sim0077.csv
    Ignored:    sbatch/makefile_demo/sims/sim0078.csv
    Ignored:    sbatch/makefile_demo/sims/sim0079.csv
    Ignored:    sbatch/makefile_demo/sims/sim0080.csv
    Ignored:    sbatch/makefile_demo/sims/sim0081.csv
    Ignored:    sbatch/makefile_demo/sims/sim0082.csv
    Ignored:    sbatch/makefile_demo/sims/sim0083.csv
    Ignored:    sbatch/makefile_demo/sims/sim0084.csv
    Ignored:    sbatch/makefile_demo/sims/sim0085.csv
    Ignored:    sbatch/makefile_demo/sims/sim0086.csv
    Ignored:    sbatch/makefile_demo/sims/sim0087.csv
    Ignored:    sbatch/makefile_demo/sims/sim0088.csv
    Ignored:    sbatch/makefile_demo/sims/sim0089.csv
    Ignored:    sbatch/makefile_demo/sims/sim0090.csv
    Ignored:    sbatch/makefile_demo/sims/sim0091.csv
    Ignored:    sbatch/makefile_demo/sims/sim0092.csv
    Ignored:    sbatch/makefile_demo/sims/sim0093.csv
    Ignored:    sbatch/makefile_demo/sims/sim0094.csv
    Ignored:    sbatch/makefile_demo/sims/sim0095.csv
    Ignored:    sbatch/makefile_demo/sims/sim0096.csv
    Ignored:    sbatch/makefile_demo/sims/sim0097.csv
    Ignored:    sbatch/makefile_demo/sims/sim0098.csv
    Ignored:    sbatch/makefile_demo/sims/sim0099.csv
    Ignored:    sbatch/makefile_demo/sims/sim0100.csv
    Ignored:    sbatch/makefile_demo/sims/sim0101.csv
    Ignored:    sbatch/makefile_demo/sims/sim0102.csv
    Ignored:    sbatch/makefile_demo/sims/sim0103.csv
    Ignored:    sbatch/makefile_demo/sims/sim0104.csv
    Ignored:    sbatch/makefile_demo/sims/sim0105.csv
    Ignored:    sbatch/makefile_demo/sims/sim0106.csv
    Ignored:    sbatch/makefile_demo/sims/sim0107.csv
    Ignored:    sbatch/makefile_demo/sims/sim0108.csv
    Ignored:    sbatch/makefile_demo/sims/sim0109.csv
    Ignored:    sbatch/makefile_demo/sims/sim0110.csv
    Ignored:    sbatch/makefile_demo/sims/sim0111.csv
    Ignored:    sbatch/makefile_demo/sims/sim0112.csv
    Ignored:    sbatch/makefile_demo/sims/sim0113.csv
    Ignored:    sbatch/makefile_demo/sims/sim0114.csv
    Ignored:    sbatch/makefile_demo/sims/sim0115.csv
    Ignored:    sbatch/makefile_demo/sims/sim0116.csv
    Ignored:    sbatch/makefile_demo/sims/sim0117.csv
    Ignored:    sbatch/makefile_demo/sims/sim0118.csv
    Ignored:    sbatch/makefile_demo/sims/sim0119.csv
    Ignored:    sbatch/makefile_demo/sims/sim0120.csv
    Ignored:    sbatch/makefile_demo/sims/sim0121.csv
    Ignored:    sbatch/makefile_demo/sims/sim0122.csv
    Ignored:    sbatch/makefile_demo/sims/sim0123.csv
    Ignored:    sbatch/makefile_demo/sims/sim0124.csv
    Ignored:    sbatch/makefile_demo/sims/sim0125.csv
    Ignored:    sbatch/makefile_demo/sims/sim0126.csv
    Ignored:    sbatch/makefile_demo/sims/sim0127.csv
    Ignored:    sbatch/makefile_demo/sims/sim0128.csv
    Ignored:    sbatch/makefile_demo/sims/sim0129.csv
    Ignored:    sbatch/makefile_demo/sims/sim0130.csv
    Ignored:    sbatch/makefile_demo/sims/sim0131.csv
    Ignored:    sbatch/makefile_demo/sims/sim0132.csv
    Ignored:    sbatch/makefile_demo/sims/sim0133.csv
    Ignored:    sbatch/makefile_demo/sims/sim0134.csv
    Ignored:    sbatch/makefile_demo/sims/sim0135.csv
    Ignored:    sbatch/makefile_demo/sims/sim0136.csv
    Ignored:    sbatch/makefile_demo/sims/sim0137.csv
    Ignored:    sbatch/makefile_demo/sims/sim0138.csv
    Ignored:    sbatch/makefile_demo/sims/sim0139.csv
    Ignored:    sbatch/makefile_demo/sims/sim0140.csv
    Ignored:    sbatch/makefile_demo/sims/sim0141.csv
    Ignored:    sbatch/makefile_demo/sims/sim0142.csv
    Ignored:    sbatch/makefile_demo/sims/sim0143.csv
    Ignored:    sbatch/makefile_demo/sims/sim0144.csv
    Ignored:    sbatch/makefile_demo/sims/sim0145.csv
    Ignored:    sbatch/makefile_demo/sims/sim0146.csv
    Ignored:    sbatch/makefile_demo/sims/sim0147.csv
    Ignored:    sbatch/makefile_demo/sims/sim0148.csv
    Ignored:    sbatch/makefile_demo/sims/sim0149.csv
    Ignored:    sbatch/makefile_demo/sims/sim0150.csv
    Ignored:    sbatch/makefile_demo/sims/sim0151.csv
    Ignored:    sbatch/makefile_demo/sims/sim0152.csv
    Ignored:    sbatch/makefile_demo/sims/sim0153.csv
    Ignored:    sbatch/makefile_demo/sims/sim0154.csv
    Ignored:    sbatch/makefile_demo/sims/sim0155.csv
    Ignored:    sbatch/makefile_demo/sims/sim0156.csv
    Ignored:    sbatch/makefile_demo/sims/sim0157.csv
    Ignored:    sbatch/makefile_demo/sims/sim0158.csv
    Ignored:    sbatch/makefile_demo/sims/sim0159.csv
    Ignored:    sbatch/makefile_demo/sims/sim0160.csv
    Ignored:    sbatch/makefile_demo/sims/sim0161.csv
    Ignored:    sbatch/makefile_demo/sims/sim0162.csv
    Ignored:    sbatch/makefile_demo/sims/sim0163.csv
    Ignored:    sbatch/makefile_demo/sims/sim0164.csv
    Ignored:    sbatch/makefile_demo/sims/sim0165.csv
    Ignored:    sbatch/makefile_demo/sims/sim0166.csv
    Ignored:    sbatch/makefile_demo/sims/sim0167.csv
    Ignored:    sbatch/makefile_demo/sims/sim0168.csv
    Ignored:    sbatch/makefile_demo/sims/sim0169.csv
    Ignored:    sbatch/makefile_demo/sims/sim0170.csv
    Ignored:    sbatch/makefile_demo/sims/sim0171.csv
    Ignored:    sbatch/makefile_demo/sims/sim0172.csv
    Ignored:    sbatch/makefile_demo/sims/sim0173.csv
    Ignored:    sbatch/makefile_demo/sims/sim0174.csv
    Ignored:    sbatch/makefile_demo/sims/sim0175.csv
    Ignored:    sbatch/makefile_demo/sims/sim0176.csv
    Ignored:    sbatch/makefile_demo/sims/sim0177.csv
    Ignored:    sbatch/makefile_demo/sims/sim0178.csv
    Ignored:    sbatch/makefile_demo/sims/sim0179.csv
    Ignored:    sbatch/makefile_demo/sims/sim0180.csv
    Ignored:    sbatch/makefile_demo/sims/sim0181.csv
    Ignored:    sbatch/makefile_demo/sims/sim0182.csv
    Ignored:    sbatch/makefile_demo/sims/sim0183.csv
    Ignored:    sbatch/makefile_demo/sims/sim0184.csv
    Ignored:    sbatch/makefile_demo/sims/sim0185.csv
    Ignored:    sbatch/makefile_demo/sims/sim0186.csv
    Ignored:    sbatch/makefile_demo/sims/sim0187.csv
    Ignored:    sbatch/makefile_demo/sims/sim0188.csv
    Ignored:    sbatch/makefile_demo/sims/sim0189.csv
    Ignored:    sbatch/makefile_demo/sims/sim0190.csv
    Ignored:    sbatch/makefile_demo/sims/sim0191.csv
    Ignored:    sbatch/makefile_demo/sims/sim0192.csv
    Ignored:    sbatch/makefile_demo/sims/sim0193.csv
    Ignored:    sbatch/makefile_demo/sims/sim0194.csv
    Ignored:    sbatch/makefile_demo/sims/sim0195.csv
    Ignored:    sbatch/makefile_demo/sims/sim0196.csv
    Ignored:    sbatch/makefile_demo/sims/sim0197.csv
    Ignored:    sbatch/makefile_demo/sims/sim0198.csv
    Ignored:    sbatch/makefile_demo/sims/sim0199.csv
    Ignored:    sbatch/makefile_demo/sims/sim0200.csv
    Ignored:    sbatch/makefile_demo/sims/sim0201.csv
    Ignored:    sbatch/makefile_demo/sims/sim0202.csv
    Ignored:    sbatch/makefile_demo/sims/sim0203.csv
    Ignored:    sbatch/makefile_demo/sims/sim0204.csv
    Ignored:    sbatch/makefile_demo/sims/sim0205.csv
    Ignored:    sbatch/makefile_demo/sims/sim0206.csv
    Ignored:    sbatch/makefile_demo/sims/sim0207.csv
    Ignored:    sbatch/makefile_demo/sims/sim0208.csv
    Ignored:    sbatch/makefile_demo/sims/sim0209.csv
    Ignored:    sbatch/makefile_demo/sims/sim0210.csv
    Ignored:    sbatch/makefile_demo/sims/sim0211.csv
    Ignored:    sbatch/makefile_demo/sims/sim0212.csv
    Ignored:    sbatch/makefile_demo/sims/sim0213.csv
    Ignored:    sbatch/makefile_demo/sims/sim0214.csv
    Ignored:    sbatch/makefile_demo/sims/sim0215.csv
    Ignored:    sbatch/makefile_demo/sims/sim0216.csv
    Ignored:    sbatch/makefile_demo/sims/sim0217.csv
    Ignored:    sbatch/makefile_demo/sims/sim0218.csv
    Ignored:    sbatch/makefile_demo/sims/sim0219.csv
    Ignored:    sbatch/makefile_demo/sims/sim0220.csv
    Ignored:    sbatch/makefile_demo/sims/sim0221.csv
    Ignored:    sbatch/makefile_demo/sims/sim0222.csv
    Ignored:    sbatch/makefile_demo/sims/sim0223.csv
    Ignored:    sbatch/makefile_demo/sims/sim0224.csv
    Ignored:    sbatch/makefile_demo/sims/sim0225.csv
    Ignored:    sbatch/makefile_demo/sims/sim0226.csv
    Ignored:    sbatch/makefile_demo/sims/sim0227.csv
    Ignored:    sbatch/makefile_demo/sims/sim0228.csv
    Ignored:    sbatch/makefile_demo/sims/sim0229.csv
    Ignored:    sbatch/makefile_demo/sims/sim0230.csv
    Ignored:    sbatch/makefile_demo/sims/sim0231.csv
    Ignored:    sbatch/makefile_demo/sims/sim0232.csv
    Ignored:    sbatch/makefile_demo/sims/sim0233.csv
    Ignored:    sbatch/makefile_demo/sims/sim0234.csv
    Ignored:    sbatch/makefile_demo/sims/sim0235.csv
    Ignored:    sbatch/makefile_demo/sims/sim0236.csv
    Ignored:    sbatch/makefile_demo/sims/sim0237.csv
    Ignored:    sbatch/makefile_demo/sims/sim0238.csv
    Ignored:    sbatch/makefile_demo/sims/sim0239.csv
    Ignored:    sbatch/makefile_demo/sims/sim0240.csv
    Ignored:    sbatch/makefile_demo/sims/sim0241.csv
    Ignored:    sbatch/makefile_demo/sims/sim0242.csv
    Ignored:    sbatch/makefile_demo/sims/sim0243.csv
    Ignored:    sbatch/makefile_demo/sims/sim0244.csv
    Ignored:    sbatch/makefile_demo/sims/sim0245.csv
    Ignored:    sbatch/makefile_demo/sims/sim0246.csv
    Ignored:    sbatch/makefile_demo/sims/sim0247.csv
    Ignored:    sbatch/makefile_demo/sims/sim0248.csv
    Ignored:    sbatch/makefile_demo/sims/sim0249.csv
    Ignored:    sbatch/makefile_demo/sims/sim0250.csv

Untracked files:
    Untracked:  R/demo.nmf.R
    Untracked:  R/nmfmu.R
    Untracked:  R/scd.R
    Untracked:  analysis/linreg_methods_demo_cache/

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were
made to the R Markdown (<code>analysis/linreg_methods_demo.Rmd</code>)
and HTML (<code>docs/linreg_methods_demo.html</code>) files. If you’ve
configured a remote Git repository (see <code>?wflow_git_remote</code>),
click on the hyperlinks in the table below to view the files as they
were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/f9c677ac80711d9ca0b882f42c4847bbd6c44359/analysis/linreg_methods_demo.Rmd" target="_blank">f9c677a</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-06-02
</td>
<td>
workflowr::wflow_publish("linreg_methods_demo.Rmd", verbose = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/pcarbo/pcarbo/aedfff2af0e98d901e0994db4659a6cd08403b69/docs/linreg_methods_demo.html" target="_blank">aedfff2</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-06-01
</td>
<td>
Added sslasso to linreg_methods_demo.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/103a6e55111a26f40f37d95794c0f6c7be462fd0/analysis/linreg_methods_demo.Rmd" target="_blank">103a6e5</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-06-01
</td>
<td>
workflowr::wflow_publish("linreg_methods_demo.Rmd", verbose = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/pcarbo/pcarbo/6023561ff585ad53485cbe4c91ee6d9da24416a6/docs/linreg_methods_demo.html" target="_blank">6023561</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-30
</td>
<td>
Added dlbayes results to linreg_methods_demo.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/ea973fb2afc82cc3bd3e08eeba8a18cae5a216c7/analysis/linreg_methods_demo.Rmd" target="_blank">ea973fb</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-30
</td>
<td>
workflowr::wflow_publish("linreg_methods_demo.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/pcarbo/pcarbo/d28532be6ab925a175ced3d1ceccd5ecb297f6e1/docs/linreg_methods_demo.html" target="_blank">d28532b</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-25
</td>
<td>
Added horseshoe to the linreg_methods_demo.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/26942a151f3cb2e60060194e0c544916d20b72be/analysis/linreg_methods_demo.Rmd" target="_blank">26942a1</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-25
</td>
<td>
workflowr::wflow_publish("linreg_methods_demo.Rmd", verbose = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/pcarbo/pcarbo/50b708a50016d92f93dd3ad8eafda3dec6d331c1/docs/linreg_methods_demo.html" target="_blank">50b708a</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-24
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/8655897c9e0bc384472f3a70243db85e210da8ec/analysis/linreg_methods_demo.Rmd" target="_blank">8655897</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-24
</td>
<td>
workflowr::wflow_publish("linreg_methods_demo.Rmd", verbose = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/pcarbo/pcarbo/33e926efdd1de25ff1066ab7a5f69dc7e295c646/docs/linreg_methods_demo.html" target="_blank">33e926e</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-24
</td>
<td>
Rebuilt the linreg_methods_demo page.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/cd402417370d426030a0f907fe78bf24c07e3efa/analysis/linreg_methods_demo.Rmd" target="_blank">cd40241</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-23
</td>
<td>
Added some text to accompany the trimmed lasso stuff in
linreg_methods_demo.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/pcarbo/pcarbo/a944fbf90d8e16cc6d5b174ca5168529180ddaf0/docs/linreg_methods_demo.html" target="_blank">a944fbf</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-23
</td>
<td>
Rebuilt the linreg_methods_demo page after a few changes to the
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/9274073a830fa4cecc2f56d9c19681633f82a824/analysis/linreg_methods_demo.Rmd" target="_blank">9274073</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-23
</td>
<td>
Revised trimmed_lasso.m script to generate fits for several values of k.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/4d3757ad9740628d0407a3aaee20a38d5a8e5fa0/analysis/linreg_methods_demo.Rmd" target="_blank">4d3757a</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-23
</td>
<td>
Small fix to linreg_methods_demo.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/pcarbo/pcarbo/13c42ec80be7caa933cd4debbeaf1b36085e7ecd/docs/linreg_methods_demo.html" target="_blank">13c42ec</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-23
</td>
<td>
Added trimmed lasso results to linreg_methods_demo page.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/f73afa4fe3970b3ed8f7e66782866ed580998a70/analysis/linreg_methods_demo.Rmd" target="_blank">f73afa4</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-23
</td>
<td>
workflowr::wflow_publish("linreg_methods_demo.Rmd")
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/3e6b925081ffb155b47bde12daedcd8364d68bbb/analysis/linreg_methods_demo.Rmd" target="_blank">3e6b925</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-23
</td>
<td>
Added trimmed lasso script and started incorporating the results into
the linreg_methods_demo.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/pcarbo/pcarbo/f1ba3dd7f54f00d5dd2e440060fe9a03bf6ca4cf/docs/linreg_methods_demo.html" target="_blank">f1ba3dd</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-17
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/3083353b6e37535e57d8e372ab21239c5224ed7c/analysis/linreg_methods_demo.Rmd" target="_blank">3083353</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-17
</td>
<td>
workflowr::wflow_publish("linreg_methods_demo.Rmd")
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/pcarbo/pcarbo/2ea7aaaa555ac055da621cc242ba5781e8b12a12/docs/linreg_methods_demo.html" target="_blank">2ea7aaa</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-13
</td>
<td>
Fixed one of the scatterplots in the linreg_methods_demo.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/8d721cf00b95b7674cd3e358eaf1bdd842384c3b/analysis/linreg_methods_demo.Rmd" target="_blank">8d721cf</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-13
</td>
<td>
workflowr::wflow_publish("linreg_methods_demo.Rmd", verbose = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/pcarbo/pcarbo/d548844efb9bc4b9747a196f340e42805e42cdda/docs/linreg_methods_demo.html" target="_blank">d548844</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-13
</td>
<td>
Added L0Learn to linreg_methods_demo.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/eaecd02594c14e48a279d8c07ee5add351a1f085/analysis/linreg_methods_demo.Rmd" target="_blank">eaecd02</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-13
</td>
<td>
workflowr::wflow_publish("linreg_methods_demo.Rmd", verbose = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/pcarbo/pcarbo/6182121cf30a7bc351295fd5323b6beb97138404/docs/linreg_methods_demo.html" target="_blank">6182121</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-09
</td>
<td>
Added emvs to linreg_methods_demo.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/97c6939f35b9dcf0b1480132ceb6df593cdc57f3/analysis/linreg_methods_demo.Rmd" target="_blank">97c6939</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-09
</td>
<td>
wflow_publish("linreg_methods_demo.Rmd", verbose = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/pcarbo/pcarbo/1f3207838e331a8e4e1ac65614c87c0877b04d0b/docs/linreg_methods_demo.html" target="_blank">1f32078</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-09
</td>
<td>
First build of linreg_methods_demo.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/0b8238edae155e56c6125f2a60d85a19156904b3/analysis/linreg_methods_demo.Rmd" target="_blank">0b8238e</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-09
</td>
<td>
workflowr::wflow_publish("linreg_methods_demo.Rmd", verbose = TRUE)
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<p><em>Add overview here.</em></p>
<p>Load the packages and set the seed so that we may reproduce the
results more easily.</p>
<pre class="r"><code>library(MASS)
library(L0Learn)
library(horseshoe)
library(bayeslm)
library(dlbayes)
library(SSLASSO)
library(EMVS)
library(R.matlab)
library(ggplot2)
library(cowplot)
set.seed(1)
source(&quot;../R/linreg_methods_demo_functions.R&quot;)</code></pre>
<p>Simulate a data set with correlated variables in a similar way to
Example 1 from <a
href="https://doi.org/10.1111/j.1467-9868.2005.00503.x">Zou &amp; Hastie
2005</a>.</p>
<pre class="r"><code>simulate_predictors_decaying_corr &lt;- function (n, p, s = 0.5)
  return(mvrnorm(n,rep(0,p),s^abs(outer(1:p,1:p,&quot;-&quot;))))
simulate_outcomes &lt;- function (X, b, se)
  return(drop(X %*% b - 1 + rnorm(nrow(X),sd = se)))
p      &lt;- 1000
se     &lt;- 3
b      &lt;- rep(0,p)
b[1:3] &lt;- c(3,1.5,2)
Xtrain &lt;- simulate_predictors_decaying_corr(200,p,0.5)
Xtest  &lt;- simulate_predictors_decaying_corr(500,p,0.5)
train  &lt;- list(X = Xtrain,y = simulate_outcomes(Xtrain,b,se))
test   &lt;- list(X = Xtest,y = simulate_outcomes(Xtest,b,se))
btrue  &lt;- b</code></pre>
<p>Save the data to a MAT file for running the Trimmed Lasso. (The data
are centered because the Trimmed Lasso does not include an
intercept.)</p>
<pre class="r"><code>writeMat(&quot;train.mat&quot;,
         X = scale(train$X,center = TRUE,scale = FALSE),
         y = with(train,y - mean(y)))</code></pre>
<div id="l0learn" class="section level2">
<h2>L0Learn</h2>
<p>First, let’s try the <a
href="https://cran.r-project.org/package=L0Learn">L0Learn</a> from <a
href="https://doi.org/10.1287/opre.2019.1919">Hazimeh &amp; Mazumder
2020</a>. In the <a
href="https://cran.r-project.org/web/packages/L0Learn/vignettes/L0Learn-vignette.html">vignette</a>,
the authors suggest using the “L0L1” or “L0L2” penalties for better
predictive performance. The package includes an interface to
automatically select the penalty parameters <span
class="math inline">\(\lambda, \gamma\)</span> that minimize the
test-set error. (L0Learn has two model fitting algorithms; the CD
algorithm is faster whereas the CDPSI can sometimes produces better
fits. For expediency we’ll use the CD algorithm.)</p>
<pre class="r"><code>l0learn_cv &lt;- with(train,L0Learn.cvfit(X,y,penalty = &quot;L0L1&quot;,algorithm = &quot;CD&quot;))
i      &lt;- which.min(sapply(l0learn_cv$cvMeans,min))
j      &lt;- which.min(l0learn_cv$cvMeans[[i]])
gamma  &lt;- l0learn_cv$fit$gamma[i]
lambda &lt;- l0learn_cv$fit$lambda[[i]][j]</code></pre>
<p>Compare the coefficient estimates against the ground truth:</p>
<pre class="r"><code>b &lt;- as.vector(coef(l0learn_cv,gamma = gamma,lambda = lambda))
b &lt;- b[-1]
plot_coefs(btrue,b)</code></pre>
<p><img src="figure/linreg_methods_demo.Rmd/plot-coef-l0learn-1.png" width="300" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plot-coef-l0learn-1">
Past versions of plot-coef-l0learn-1.png
</button>
</p>
<div id="fig-plot-coef-l0learn-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/f1ba3dd7f54f00d5dd2e440060fe9a03bf6ca4cf/docs/figure/linreg_methods_demo.Rmd/plot-coef-l0learn-1.png" target="_blank">f1ba3dd</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/d548844efb9bc4b9747a196f340e42805e42cdda/docs/figure/linreg_methods_demo.Rmd/plot-coef-l0learn-1.png" target="_blank">d548844</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-13
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>As expected, the L0 penalty shrinks most of the coefficients to
zero.</p>
<p>The mean squared error (MSE) summarizes the accuracy of the
predictions in the test set examples:</p>
<pre class="r"><code>y &lt;- as.vector(predict(l0learn_cv,newx = test$X,gamma = gamma,lambda = lambda))
plot_responses(test$y,y)</code></pre>
<p><img src="figure/linreg_methods_demo.Rmd/predict-l0learn-1.png" width="300" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-predict-l0learn-1">
Past versions of predict-l0learn-1.png
</button>
</p>
<div id="fig-predict-l0learn-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/f1ba3dd7f54f00d5dd2e440060fe9a03bf6ca4cf/docs/figure/linreg_methods_demo.Rmd/predict-l0learn-1.png" target="_blank">f1ba3dd</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/d548844efb9bc4b9747a196f340e42805e42cdda/docs/figure/linreg_methods_demo.Rmd/predict-l0learn-1.png" target="_blank">d548844</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-13
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Let’s compare this to L0Learn with the simpler L0 penalty (which is a
special case of the L0L1 penalty in which <span
class="math inline">\(\gamma = 0\)</span>):</p>
<pre class="r"><code>l0learn_cv &lt;- with(train,L0Learn.cvfit(X,y,penalty = &quot;L0&quot;,algorithm = &quot;CD&quot;))
i &lt;- which.min(l0learn_cv$cvMeans[[1]])
lambda &lt;- l0learn_cv$fit$lambda[[1]][i]
y &lt;- as.vector(predict(l0learn_cv,newx = test$X,lambda = lambda))
qplot(test$y,y) +
  geom_abline(intercept = 0,slope = 1,color = &quot;deepskyblue&quot;,
              linetype = &quot;dashed&quot;) +
  ggtitle(sprintf(&quot;mse = %0.3f&quot;,mse(test$y,y))) +
  theme_cowplot(font_size = 12) +
  theme(plot.title = element_text(face = &quot;plain&quot;,size = 12))</code></pre>
<p><img src="figure/linreg_methods_demo.Rmd/l0learn-l0only-1.png" width="300" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-l0learn-l0only-1">
Past versions of l0learn-l0only-1.png
</button>
</p>
<div id="fig-l0learn-l0only-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/2ea7aaaa555ac055da621cc242ba5781e8b12a12/docs/figure/linreg_methods_demo.Rmd/l0learn-l0only-1.png" target="_blank">2ea7aaa</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-13
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Indeed, in this one example at least, L0Learn with the L0L1 penalty
has better prediction performance than the L0 penalty.</p>
</div>
<div id="trimmed-lasso" class="section level2">
<h2>Trimmed Lasso</h2>
<p>The Trimmed Lasso was described by <a
href="https://doi.org/10.1137/20M1330634">Amir, Basri &amp; Nadler
2021</a>. It is implemented in <a
href="https://github.com/tal-amir/sparse-approximation-gsm">MATLAB</a>,
so there is a separate script, <code>trimmed_lasso.m</code>, to run the
method. Having run this script, we now load the results:</p>
<pre class="r"><code>k &lt;- c(1,3,10,20,100)
B &lt;- readMat(&quot;trimmed_lasso_coefs.mat&quot;)$B
colnames(B) &lt;- paste0(&quot;k&quot;,k)
b &lt;-  B[,&quot;k3&quot;]</code></pre>
<p>The Trimmed Lasso was run with different settings of the sparsity
parameter <span class="math inline">\(k\)</span>. Here we take the
setting of <span class="math inline">\(k\)</span> that is closest to the
true number of nonzero coefficients (which in this example is also 3).
As expected, the coefficient estimates are very sparse:</p>
<pre class="r"><code>plot_coefs(btrue,b)</code></pre>
<p><img src="figure/linreg_methods_demo.Rmd/plot-coef-trimmed-lasso-1.png" width="300" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plot-coef-trimmed-lasso-1">
Past versions of plot-coef-trimmed-lasso-1.png
</button>
</p>
<div id="fig-plot-coef-trimmed-lasso-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/13c42ec80be7caa933cd4debbeaf1b36085e7ecd/docs/figure/linreg_methods_demo.Rmd/plot-coef-trimmed-lasso-1.png" target="_blank">13c42ec</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-23
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>For prediction, we need to estimate the intercept. Here we compute
the MLE:</p>
<pre class="r"><code>b0 &lt;- with(train,mean(y - X %*% b))</code></pre>
<p>The Trimmed Lasso is well suited to this example because the true
coefficients are very sparse, and indeed the prediction accuracy is very
good:</p>
<pre class="r"><code>y &lt;- drop(b0 + test$X %*% b)
plot_responses(test$y,y)</code></pre>
<p><img src="figure/linreg_methods_demo.Rmd/predict-trimmed-lasso-1.png" width="300" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-predict-trimmed-lasso-1">
Past versions of predict-trimmed-lasso-1.png
</button>
</p>
<div id="fig-predict-trimmed-lasso-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/13c42ec80be7caa933cd4debbeaf1b36085e7ecd/docs/figure/linreg_methods_demo.Rmd/predict-trimmed-lasso-1.png" target="_blank">13c42ec</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-23
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>One drawback with the Trimmed Lasso is that cross-validation will be
needed to get the right <span class="math inline">\(k\)</span>. Since
cross-validation is not implemented in the software, we will have to do
it ourselves.</p>
</div>
<div id="the-horseshoe" class="section level2">
<h2>The Horseshoe</h2>
<p>Another option is multiple linear regression with the <a
href="https://doi.org/10.1093/biomet/asq017">horseshoe prior</a>. There
are several implementations in R and MATLAB listed in <a
href="https://doi.org/10.1214/19-STS700">this review paper</a>. The
recent <a href="https://doi.org/10.1080/10618600.2018.1482762">bayeslm
package</a> package implements an efficient slice sampler for multiple
linear regression with the horseshoe prior and several other priors, so
we’ll try that first.</p>
<pre class="r"><code>horseshoe &lt;- bayeslm(train$y,train$X,prior = &quot;horseshoe&quot;,icept = TRUE,
                     verb = TRUE, standardize = FALSE,singular = TRUE,
                     burnin = 1000,N = 4000)
# horseshoe prior 
# fixed running time 71.283
# 1000
# 2000
# 3000
# sampling time 31.5904</code></pre>
<div class="alert alert-warning">
<p>
<strong>Warning:</strong> The above code chunk cached its results, but
it won’t be re-run if previous chunks it depends on are updated. If you
need to use caching, it is highly recommended to also set
<code>knitr::opts_chunk$set(autodep = TRUE)</code> at the top of the
file (in a chunk that is not cached). Alternatively, you can customize
the option <code>dependson</code> for each individual chunk that is
cached. Using either <code>autodep</code> or <code>dependson</code> will
remove this warning. See the
<a href="https://yihui.name/knitr/options/#cache"
>knitr cache options</a> for more details.
</p>
</div>
<p>bayeslm also effectively shrank the coefficients and produced
accurate predictions in the example data set:</p>
<pre class="r"><code>b &lt;- colMeans(horseshoe$beta)
b &lt;- b[-1]
y &lt;- predict(horseshoe,X = test$X,burnin = 1000)
plot_grid(plot_coefs(btrue,b),
          plot_responses(test$y,y))</code></pre>
<p><img src="figure/linreg_methods_demo.Rmd/horseshoe-2-1.png" width="600" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-horseshoe-2-1">
Past versions of horseshoe-2-1.png
</button>
</p>
<div id="fig-horseshoe-2-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/6023561ff585ad53485cbe4c91ee6d9da24416a6/docs/figure/linreg_methods_demo.Rmd/horseshoe-2-1.png" target="_blank">6023561</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-30
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Next, let’s try the <a
href="https://cran.r-project.org/package=horseshoe">horseshoe
package</a>:</p>
<pre class="r"><code>X_centered &lt;- scale(train$X,center = TRUE,scale = FALSE)
y_centered &lt;- with(train,y - mean(y))
hs &lt;- horseshoe(y_centered,X_centered,method.tau = &quot;halfCauchy&quot;,
                method.sigma = &quot;Jeffreys&quot;,burn = 1000,nmc = 4000)
# [1] 1000
# [1] 2000
# [1] 3000
# [1] 4000
# [1] 5000</code></pre>
<div class="alert alert-warning">
<p>
<strong>Warning:</strong> The above code chunk cached its results, but
it won’t be re-run if previous chunks it depends on are updated. If you
need to use caching, it is highly recommended to also set
<code>knitr::opts_chunk$set(autodep = TRUE)</code> at the top of the
file (in a chunk that is not cached). Alternatively, you can customize
the option <code>dependson</code> for each individual chunk that is
cached. Using either <code>autodep</code> or <code>dependson</code> will
remove this warning. See the
<a href="https://yihui.name/knitr/options/#cache"
>knitr cache options</a> for more details.
</p>
</div>
<p>It seems to work reasonably well although in this example the bayeslm
package gave the slightly better result (perhaps because the MCMC
algorithm in bayeslm is more efficient):</p>
<pre class="r"><code>b0 &lt;- with(train,mean(y - X %*% b))
b  &lt;- hs$BetaHat
y  &lt;- drop(b0 + test$X %*% b)
plot_grid(plot_coefs(btrue,b),
          plot_responses(test$y,y))</code></pre>
<p><img src="figure/linreg_methods_demo.Rmd/horseshoe-4-1.png" width="600" style="display: block; margin: auto;" /></p>
</div>
<div id="dirichlet-laplace" class="section level2">
<h2>Dirichlet-Laplace</h2>
<p>Next I looked at the multiple linear regression with the <a
href="https://doi.org/10.1080/01621459.2014.960967">Dirichlet-Laplace
prior</a>. It is implemented in the <a
href="https://github.com/xylimeng/BayesianVariableSelection">dlbayes
package</a>. However, the package has a <a
href="https://github.com/xylimeng/BayesianVariableSelection/issues/1">bug</a>,
so you should use <a href="https://github.com/pcarbo/dlbayes">my fork of
the dlbayes package</a> which contains the bug fix. To install this
version of the package, run:</p>
<pre class="r"><code>remotes::install_github(&quot;pcarbo/dlbayes&quot;,upgrade = &quot;never&quot;)</code></pre>
<p>Since the model does not include an intercept, we center the data
before performing the multiple linear regression analysis:</p>
<pre class="r"><code>dl_hyper &lt;- dlhyper(X_centered,y_centered)
dl_out &lt;- dl(X_centered,y_centered,burn = 1000,nmc = 4000,thin = 1,
             hyper = dl_hyper)</code></pre>
<div class="alert alert-warning">
<p>
<strong>Warning:</strong> The above code chunk cached its results, but
it won’t be re-run if previous chunks it depends on are updated. If you
need to use caching, it is highly recommended to also set
<code>knitr::opts_chunk$set(autodep = TRUE)</code> at the top of the
file (in a chunk that is not cached). Alternatively, you can customize
the option <code>dependson</code> for each individual chunk that is
cached. Using either <code>autodep</code> or <code>dependson</code> will
remove this warning. See the
<a href="https://yihui.name/knitr/options/#cache"
>knitr cache options</a> for more details.
</p>
</div>
<p>Let’s compare the coefficient estimates and predictions to the ground
truth:</p>
<pre class="r"><code>b0 &lt;- with(train,mean(y - X %*% b))
b  &lt;- dlanalysis(dl_out)$betamean
y  &lt;- drop(b0 + test$X %*% b)
plot_grid(plot_coefs(btrue,b),
          plot_responses(test$y,y))</code></pre>
<p>The results are not impressive. However, it is possible that there
are better choices for the hyperparameter setting than the one given by
<code>dlhyper</code>.</p>
</div>
<div id="sslasso" class="section level2">
<h2>SSLASSO</h2>
<p>Now let’s try the <a
href="https://cran.r-project.org/package=SSLASSO">Spike-and-Slab
LASSO</a>, both the “adaptive” and “separable” variants. For the SSLASSO
with the separable penalty, it would be a bit of an unfair advantage to
set the prior inclusion probability <span
class="math inline">\(\theta\)</span> to the true value, so here we set
it to a value (0.05) larger than the true value (0.003).</p>
<pre class="r"><code>sslasso_sep &lt;-
with(train,SSLASSO(X,y,penalty = &quot;separable&quot;,variance = &quot;unknown&quot;,
                   theta = 0.05))
sslasso_adapt &lt;-
  with(train,SSLASSO(X,y,penalty = &quot;adaptive&quot;,variance = &quot;unknown&quot;,
                     lambda0 = seq(3,200,length.out = 100),lambda1 = 3))</code></pre>
<p>Note that there is a bug in SSLASSO: To override the default choice
for <code>lambda1</code>, you need to specify both <code>lambda0</code>
and <code>lambda1</code>.</p>
<p>Let’s take a look at the SSLASSO with separable penalty first. As far
as I can tell, the SSLASSO does not provide an automated way to select
the spike penalty parameter <span
class="math inline">\(\lambda_0\)</span>, so here, to keep things
simple, I choose this penalty by hand. (In general we would probably
want to implement a simple cross-validation scheme to choose this
penalty, as well as the slab penalty <span
class="math inline">\(\lambda_1\)</span>, although <a
href="https://doi.org/10.1080/01621459.2016.1260469">Rockova &amp;
George 2018</a> observe that the performance is not very sensitive to
the choice of <span class="math inline">\(\lambda_1\)</span>, so it
seems reasonable to try a small number of settings, e.g., <span
class="math inline">\(\lambda_1 = \{0.1, 0.5, 1, 5, 10\}\)</span>,
similar to what was done in the SSLASSO paper.)</p>
<pre class="r"><code>i &lt;- 8
b &lt;- sslasso_sep$beta[,i]
plot_coefs(btrue,b)</code></pre>
<p><img src="figure/linreg_methods_demo.Rmd/plot-coef-sslasso-sep-1.png" width="300" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plot-coef-sslasso-sep-1">
Past versions of plot-coef-sslasso-sep-1.png
</button>
</p>
<div id="fig-plot-coef-sslasso-sep-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/aedfff2af0e98d901e0994db4659a6cd08403b69/docs/figure/linreg_methods_demo.Rmd/plot-coef-sslasso-sep-1.png" target="_blank">aedfff2</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/1f3207838e331a8e4e1ac65614c87c0877b04d0b/docs/figure/linreg_methods_demo.Rmd/plot-coef-sslasso-sep-1.png" target="_blank">1f32078</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Compare these estimates to the estimates obtained by the adaptive
SSLASSO:</p>
<pre class="r"><code>b &lt;- sslasso_adapt$beta[,i]
plot_coefs(btrue,b)</code></pre>
<p><img src="figure/linreg_methods_demo.Rmd/plot-coef-sslasso-adapt-1.png" width="300" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-plot-coef-sslasso-adapt-1">
Past versions of plot-coef-sslasso-adapt-1.png
</button>
</p>
<div id="fig-plot-coef-sslasso-adapt-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/aedfff2af0e98d901e0994db4659a6cd08403b69/docs/figure/linreg_methods_demo.Rmd/plot-coef-sslasso-adapt-1.png" target="_blank">aedfff2</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/1f3207838e331a8e4e1ac65614c87c0877b04d0b/docs/figure/linreg_methods_demo.Rmd/plot-coef-sslasso-adapt-1.png" target="_blank">1f32078</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Observe that the adaptive variant did a much better job shrinking the
small coefficients to zero. Both methods accurately estimated the
residual variance:</p>
<pre class="r"><code>tail(sslasso_sep$sigmas,n = 1)
tail(sslasso_adapt$sigmas,n = 1)
# [1] 3.157303
# [1] 3.162328</code></pre>
<p>SSLASSO package does not provide a “predict” method so we need to
compute the predictions by hand after extracting the coefficient
estimates.</p>
<pre class="r"><code>b0 &lt;- sslasso_sep$intercept[i]
b  &lt;- sslasso_sep$beta[,i]
y  &lt;- drop(b0 + test$X %*% b)
p1 &lt;- plot_responses(test$y,y)
b0 &lt;- sslasso_adapt$intercept[i]
b  &lt;- sslasso_adapt$beta[,i]
y  &lt;- drop(b0 + test$X %*% b)
p2 &lt;- plot_responses(test$y,y)
plot_grid(p1,p2)</code></pre>
<p><img src="figure/linreg_methods_demo.Rmd/predict-sslasso-1.png" width="600" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-predict-sslasso-1">
Past versions of predict-sslasso-1.png
</button>
</p>
<div id="fig-predict-sslasso-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/aedfff2af0e98d901e0994db4659a6cd08403b69/docs/figure/linreg_methods_demo.Rmd/predict-sslasso-1.png" target="_blank">aedfff2</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/d548844efb9bc4b9747a196f340e42805e42cdda/docs/figure/linreg_methods_demo.Rmd/predict-sslasso-1.png" target="_blank">d548844</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/6182121cf30a7bc351295fd5323b6beb97138404/docs/figure/linreg_methods_demo.Rmd/predict-sslasso-1.png" target="_blank">6182121</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-09
</td>
</tr>
<tr>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/1f3207838e331a8e4e1ac65614c87c0877b04d0b/docs/figure/linreg_methods_demo.Rmd/predict-sslasso-1.png" target="_blank">1f32078</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>In this example, the adaptive penalty performed a bit better than the
separable penalty with <span class="math inline">\(\theta =
0.05\)</span>.</p>
</div>
<div id="emvs" class="section level2">
<h2>EMVS</h2>
<p>The <a href="https://cran.r-project.org/package=EMVS">EMVS
package</a> seems to be better documented (unfortunately, it was removed
from CRAN). It also has two variants with different priors, the
“independent” prior (which is recommended by the authors) and the
“conjugate” prior. Let’s compare their performance in this simulated
example.</p>
<pre class="r"><code>emvs_conj = with(train,
  EMVS(y,X,v0 = seq(0.1,2,length.out = 20),v1 = 10,independent = FALSE))
emvs_ind = with(train,
  EMVS(y,X,v0 = exp(seq(-18,-1,length.out = 20)),v1 = 1,independent = TRUE))</code></pre>
<p><em>Add text here.</em></p>
<pre class="r"><code>i  &lt;- which.max(emvs_conj$log_g_function)
b  &lt;- with(emvs_conj,betas[i,] * prob_inclusion[i,])
qplot(btrue,b) +
  geom_abline(intercept = 0,slope = 1,color = &quot;deepskyblue&quot;,
              linetype = &quot;dashed&quot;) +
  theme_cowplot(font_size = 12)</code></pre>
<p><img src="figure/linreg_methods_demo.Rmd/emvs-conj-1.png" width="300" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-emvs-conj-1">
Past versions of emvs-conj-1.png
</button>
</p>
<div id="fig-emvs-conj-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/6182121cf30a7bc351295fd5323b6beb97138404/docs/figure/linreg_methods_demo.Rmd/emvs-conj-1.png" target="_blank">6182121</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><em>Add text here.</em></p>
<pre class="r"><code>b &lt;- with(emvs_ind,betas[14,] * prob_inclusion[14,])
qplot(btrue,b) +
  geom_abline(intercept = 0,slope = 1,color = &quot;deepskyblue&quot;,
              linetype = &quot;dashed&quot;) +
  theme_cowplot(font_size = 12)</code></pre>
<p><img src="figure/linreg_methods_demo.Rmd/emvs-ind-1.png" width="300" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-emvs-ind-1">
Past versions of emvs-ind-1.png
</button>
</p>
<div id="fig-emvs-ind-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/6182121cf30a7bc351295fd5323b6beb97138404/docs/figure/linreg_methods_demo.Rmd/emvs-ind-1.png" target="_blank">6182121</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><em>Add text here.</em></p>
<pre class="r"><code>b0 &lt;- emvs_conj$intersects[i]
b  &lt;- emvs_conj$betas[i,]
y  &lt;- drop(b0 + test$X %*% b)
p1 &lt;- qplot(test$y,y) +
  geom_abline(intercept = 0,slope = 1,color = &quot;deepskyblue&quot;,
              linetype = &quot;dashed&quot;) +
  ggtitle(sprintf(&quot;conjugate (mse = %0.3f)&quot;,mse(test$y,y))) +
  theme_cowplot(font_size = 12)
b0 &lt;- emvs_ind$intersects[14]
b  &lt;- emvs_ind$beta[14,]
y  &lt;- drop(b0 + test$X %*% b)
p2 &lt;- qplot(test$y,y) +
  geom_abline(intercept = 0,slope = 1,color = &quot;deepskyblue&quot;,
              linetype = &quot;dashed&quot;) +
  ggtitle(sprintf(&quot;independent (mse = %0.3f)&quot;,mse(test$y,y))) +
  theme_cowplot(font_size = 12)
plot_grid(p1,p2)</code></pre>
<p><img src="figure/linreg_methods_demo.Rmd/predict-emvs-1.png" width="600" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-predict-emvs-1">
Past versions of predict-emvs-1.png
</button>
</p>
<div id="fig-predict-emvs-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/d548844efb9bc4b9747a196f340e42805e42cdda/docs/figure/linreg_methods_demo.Rmd/predict-emvs-1.png" target="_blank">d548844</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/pcarbo/pcarbo/blob/6182121cf30a7bc351295fd5323b6beb97138404/docs/figure/linreg_methods_demo.Rmd/predict-emvs-1.png" target="_blank">6182121</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2023-05-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()
# R version 3.6.2 (2019-12-12)
# Platform: x86_64-apple-darwin15.6.0 (64-bit)
# Running under: macOS Catalina 10.15.7
# 
# Matrix products: default
# BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
# LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
# 
# locale:
# [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
# 
# attached base packages:
# [1] stats     graphics  grDevices utils     datasets  methods   base     
# 
# other attached packages:
#  [1] cowplot_1.1.1   ggplot2_3.3.6   R.matlab_3.6.2  EMVS_1.2.1     
#  [5] SSLASSO_1.2-2   dlbayes_0.1.1   bayeslm_1.0.1   horseshoe_0.2.0
#  [9] L0Learn_2.1.0   MASS_7.3-51.4  
# 
# loaded via a namespace (and not attached):
#  [1] Rcpp_1.0.8         lattice_0.20-38    assertthat_0.2.1   rprojroot_2.0.3   
#  [5] digest_0.6.23      utf8_1.1.4         R6_2.4.1           plyr_1.8.5        
#  [9] evaluate_0.14      coda_0.19-3        highr_0.8          pillar_1.6.2      
# [13] rlang_1.0.6        whisker_0.4        jquerylib_0.1.4    R.utils_2.11.0    
# [17] R.oo_1.24.0        Matrix_1.3-4       rmarkdown_2.21     labeling_0.3      
# [21] stringr_1.4.0      munsell_0.5.0      compiler_3.6.2     httpuv_1.5.2      
# [25] xfun_0.39.1        pkgconfig_2.0.3    htmltools_0.5.4    tidyselect_1.1.1  
# [29] tibble_3.1.3       workflowr_1.7.0.5  fansi_0.4.0        crayon_1.4.1      
# [33] dplyr_1.0.7        withr_2.5.0        later_1.0.0        R.methodsS3_1.8.1 
# [37] grid_3.6.2         jsonlite_1.7.2     gtable_0.3.0       lifecycle_1.0.3   
# [41] DBI_1.1.0          git2r_0.29.0       magrittr_2.0.1     scales_1.1.0      
# [45] RcppParallel_5.1.5 cli_3.5.0          stringi_1.4.3      farver_2.0.1      
# [49] reshape2_1.4.3     fs_1.5.2           promises_1.1.0     bslib_0.3.1       
# [53] ellipsis_0.3.2     generics_0.0.2     vctrs_0.3.8        tools_3.6.2       
# [57] glue_1.4.2         purrr_0.3.4        fastmap_1.1.0      yaml_2.2.0        
# [61] colorspace_1.4-1   knitr_1.37         sass_0.4.0</code></pre>
</div>
</div>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>

<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>





</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
